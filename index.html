<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <base href="/monkeynad.fun/">
    <link rel="icon" href="favicon.png" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="theme-color" content="#000000" />
    <meta name="title" content="ApeEscape Remastered" />
    <meta name="description" content="ApeEscape BananaFarm" />
    <meta name="keywords" content="ApeEscape, BNB, DAPP, BananaFarm" />
    <link rel="apple-touch-icon" href="logo.png" />
    <meta property="og:image" content="logo.png" />
    <meta property="og:image:secure_url" content="logo.png" />
    <meta property="og:image:alt" content="ApeEscape Bananafarm" />
    <meta property="og:title" content="ApeEscape Bananafarm" />
    <meta property="og:description" content="BananaFarm" />
    <link rel="manifest" href="manifest.json" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400;600;700&display=swap"
      rel="stylesheet"
    />
    <style>
      @font-face {
        font-family: "PoseyTextured";
        src: url("poseytextured.woff2") format("woff2");
      }
      body {
        font-family: "PoseyTextured", Montserrat, sans-serif;
      }
      #wallet-popup {
        display: none;
        position: fixed;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        background: white;
        padding: 20px;
        border-radius: 12px;
        box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
        text-align: center;
        width: 300px;
        z-index: 9999;
      }
      .wallet-option {
        display: flex;
        align-items: center;
        background: #f4f4f4;
        padding: 10px;
        border-radius: 8px;
        cursor: pointer;
        margin: 10px 0;
        padding: 10px;
      }
      .wallet-option:hover {
        background: #ddd;
      }
      .wallet-option img {
        width: 40px;
        height: 40px;
        margin-right: 10px;
      }
      #overlay {
        display: none;
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.5);
        z-index: 9998;
      }
    </style>
    <title>ApeEscape Bananafarm</title>
  </head>

  <body>
    <noscript>You need to enable JavaScript to run this app.</noscript>

    <div id="root"></div>

    <!-- Wallet Selection Pop-up -->
    <div id="overlay"></div>
    <div id="wallet-popup">
      <h2>Select a Wallet</h2>
      <div id="wallet-list"></div>
    </div>

    <!-- JavaScript for Wallet Selection -->
    <script>
      document.addEventListener("DOMContentLoaded", function () {
        console.log("‚úÖ Page loaded. Wallet connection ready...");
        
        // Bind existing UI connect button
        const existingConnectBtn = document.querySelector("[data-wallet-connect]");
        if (existingConnectBtn) {
          existingConnectBtn.addEventListener("click", showWalletPopup);
        }
      });

      function showWalletPopup() {
        let wallets = detectWallets();

        if (wallets.length > 0) {
          document.getElementById("wallet-list").innerHTML = wallets
            .map(
              (wallet) => `
              <div class="wallet-option" onclick="connectWallet('${wallet.id}')">
                <img src="${wallet.icon}" alt="${wallet.name}" />
                <span>${wallet.name}</span>
              </div>`
            )
            .join("");
          document.getElementById("wallet-popup").style.display = "block";
          document.getElementById("overlay").style.display = "block";
        } else {
          alert("No supported wallet found. Please install SafePal, MetaMask, or Trust Wallet.");
        }
      }

      function detectWallets() {
        let availableWallets = [];

        if (window.safepalProvider) {
          availableWallets.push({
            id: "safepal",
            name: "SafePal",
            icon: "https://safepal.io/favicon.ico",
          });
        }
        if (window.ethereum && window.ethereum.isMetaMask) {
          availableWallets.push({
            id: "metamask",
            name: "MetaMask",
            icon: "https://cdn.jsdelivr.net/gh/MetaMask/brand-resources/metamask-fox.svg",
          });
        }
        if (window.trustwallet) {
          availableWallets.push({
            id: "trustwallet",
            name: "Trust Wallet",
            icon: "https://trustwallet.com/assets/images/favicon.ico",
          });
        }
        return availableWallets;
      }

      async function connectWallet(walletId) {
        document.getElementById("wallet-popup").style.display = "none";
        document.getElementById("overlay").style.display = "none";

        let provider = null;

        if (walletId === "safepal") {
          provider = window.safepalProvider;
        } else if (walletId === "metamask") {
          provider = window.ethereum;
        } else if (walletId === "trustwallet") {
          provider = window.trustwallet;
        }

        if (provider && provider.request) {
          try {
            console.log(`üîÑ Connecting to ${walletId}...`);
            const accounts = await provider.request({ method: "eth_requestAccounts" });
            console.log("‚úÖ Wallet connected:", accounts[0]);

            // Update the UI
            const existingConnectBtn = document.querySelector("[data-wallet-connect]");
            if (existingConnectBtn) {
              existingConnectBtn.innerText = "Disconnect";
              existingConnectBtn.onclick = disconnectWallet;
            }
          } catch (error) {
            console.error(`‚ö†Ô∏è Connection failed for ${walletId}:`, error);
          }
        }
      }

      function disconnectWallet() {
        console.log("üî¥ Disconnecting wallet...");
        localStorage.removeItem("wallet_address");

        // Reset button state
        const existingConnectBtn = document.querySelector("[data-wallet-connect]");
        if (existingConnectBtn) {
          existingConnectBtn.innerText = "Connect Wallet";
          existingConnectBtn.onclick = showWalletPopup;
        }
      }
    </script>

    <!-- Load the main JavaScript file -->
    <script defer src="static/js/main.41b81be2.js"></script>
    <link href="static/css/main.e07792ef.css" rel="stylesheet" />
  </body>
</html>
